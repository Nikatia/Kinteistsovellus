@model Kiinteistosovellus.ViewModels.MonthlyAndOtherSpendingsByMonthClass
@{
    ViewBag.Title = "Home Page";
}
<div class="jumbotron">
    <h1>ASP.NET</h1>
    <p class="lead">ASP.NET is a free web framework for building great Web sites and Web applications using HTML, CSS and JavaScript.</p>
    <div>
        <div class="row">
            <div class="col-md-6">
                <div id="chartContainer"></div>
                <div style="padding-left:60px">@Html.DropDownListFor(model => model.Vuosi, null, htmlAttributes: new { @class = "form-control" })</div>
            </div>
            <div class="col-md-6">
                <div id="chartContainerLine"></div>
                <div style="padding-left:60px">@Html.DropDownList("VuosiLine", null, htmlAttributes: new { @class = "form-control"})</div>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(async function () {
        var thisYear = new Date().getFullYear();
        document.getElementById("Vuosi").value = thisYear;
        document.getElementById("VuosiLine").value = thisYear;

        var url = "/Home/PieChart/?year=" + thisYear;
        var urlLine = "/Home/_LineChart/?year=" + thisYear;

        var divForPartial = $("#chartContainer");
        var divForPartialLine = $("#chartContainerLine");

        await $.ajax({
            url: url,
            cache: false,
            contentType: false,
            processData: false,
            method: 'get',
            type: "get",
            success: function (result) {
                $(divForPartial).html("");
                $(divForPartial).html(result);
            }
        });

        await $.ajax({
            url: urlLine,
            cache: false,
            contentType: false,
            processData: false,
            method: 'get',
            type: "get",
            success: function (result) {
                $(divForPartialLine).html("");
                $(divForPartialLine).html(result);
            }
        });
    });

    $('#Vuosi').change(function () {
        var thisYear = $(this).val();
        var url = "/Home/PieChart/?year=" + thisYear;
        var divForPartial = $("#chartContainer");

        $.ajax({
            url: url, 
            cache: false,
            contentType: false,
            processData: false,
            method: 'get', 
            type: "get",
            success: function (result) {
                $(divForPartial).html(""); 
                $(divForPartial).html(result); 
            }
        });
    });

    $('#VuosiLine').change(function () {
        var thisYear = $(this).val();
        var urlLine = "/Home/_LineChart/?year=" + thisYear;
        var divForPartialLine = $("#chartContainerLine");

        $.ajax({
            url: urlLine,
            cache: false,
            contentType: false,
            processData: false,
            method: 'get',
            type: "get",
            success: function (result) {
                $(divForPartialLine).html("");
                $(divForPartialLine).html(result);
            }
        });
    });

</script>
